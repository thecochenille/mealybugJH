###Figure5C
```{r}
Pkbr1Z2<-subset(dataBs,dataBs$Gene=="H.Pkbr1.Z2")
ggplot(Pkbr1Z2, aes(x=Stage.treated, y=gene.normal, fill=Treatment)) +
geom_bar(position=position_dodge(), stat="identity",
colour="black", # Use black outlines,
size=1) +      # Thinner lines
geom_errorbar(aes(ymin=gene.normal-se, ymax=gene.normal+se),
size=.8,    # Thinner lines
width=.2,
position=position_dodge(.9)) +
xlab("") +
ylab("Pkbr1 Z2 relative expression/rp49") +
scale_fill_manual(name="Treatment", # Legend label, use darker colors
breaks=c("A.Methanol", "B.5mM"),
labels=c("methanol","5mM pyriproxyfen"),
values=c("white", "#888888"))+
ggtitle("Effect of pyriproxyfen on Pkbr1 Z2") +
scale_y_continuous(breaks=seq(0,2,by = 0.01)) +
theme_bw(15)
#boxplot
Pkbr1Z2box<-subset(dataB, Gene=="H.Pkbr1.Z2")
Pkbr1Z2box
Pkbr1Z2box<-select(Pkbr1Z2box, gene.normal,Stage.treated, Treatment)
br1Z2box<-ggplot(data = Pkbr1Z2box, aes(x = Stage.treated, y = gene.normal)) +
geom_boxplot(aes(fill = Treatment), width = 0.8, size=1) +
ylab("Pkbr1 Z2 relative amount/rpL32") +
scale_fill_manual(name="", # Legend label, use darker colors
breaks=c("A.Methanol", "B.5mM"),
labels=c("methanol","5mM pyriproxyfen"),
values=c("white", "grey")) +
scale_y_continuous(breaks=seq(0,2,by = 0.01)) + theme_bw(25)
br1Z2box
postscript("Figure5C-Pkbr1Z2boxplot.ps")
br1Z2box
dev.off()
```
###Figure5D
```{r}
Pkbr1Z4<-subset(dataBs,dataBs$Gene=="I.Pkbr1.Z4")
ggplot(Pkbr1Z4, aes(x=Stage.treated, y=gene.normal, fill=Treatment)) +
geom_bar(position=position_dodge(), stat="identity",
colour="black", # Use black outlines,
size=1) +      # Thinner lines
geom_errorbar(aes(ymin=gene.normal-se, ymax=gene.normal+se),
size=.8,    # Thinner lines
width=.2,
position=position_dodge(.9)) +
xlab("") +
ylab("Pkbr1 Z4 relative expression/rp49") +
scale_fill_manual(name="Treatment", # Legend label, use darker colors
breaks=c("A.Methanol", "B.5mM"),
labels=c("methanol","5mM pyriproxyfen"),
values=c("white", "#888888"))+
ggtitle("Effect of pyriproxyfen on Pkbr1 Z4") +
scale_y_continuous(breaks=seq(0,2,by = 0.01)) +
theme_bw(15)
#boxplot
Pkbr1Z4box<-subset(dataB, Gene=="I.Pkbr1.Z4")
Pkbr1Z4box
Pkbr1Z4box<-select(Pkbr1Z4box, gene.normal,Stage.treated, Treatment)
br1Z4box<-ggplot(data = Pkbr1Z4box, aes(x = Stage.treated, y = gene.normal)) +
geom_boxplot(aes(fill = Treatment), width = 0.8, size=1) +
ylab("Pkbr1 Z2 relative amount/rpL32") +
scale_fill_manual(name="", # Legend label, use darker colors
breaks=c("A.Methanol", "B.5mM"),
labels=c("methanol","5mM pyriproxyfen"),
values=c("white", "grey")) +
scale_y_continuous(breaks=seq(0,2,by = 0.01)) + theme_bw(25)
br1Z4box
postscript("Figure5D-Pkbr1Z4boxplot.ps")
br1Z4box
dev.off()
```
###Figure5E
```{r}
Pkbr3<-subset(dataBs,dataBs$Gene=="M.Pkbr3")
ggplot(Pkbr3, aes(x=Stage.treated, y=gene.normal, fill=Treatment)) +
geom_bar(position=position_dodge(), stat="identity",
colour="black", # Use black outlines,
size=1) +      # Thinner lines
geom_errorbar(aes(ymin=gene.normal-se, ymax=gene.normal+se),
size=.8,    # Thinner lines
width=.2,
position=position_dodge(.9)) +
xlab("") +
ylab("Pkbr3 relative expression/rp49") +
scale_fill_manual(name="Treatment", # Legend label, use darker colors
breaks=c("A.Methanol", "B.5mM"),
labels=c("methanol","5mM pyriproxyfen"),
values=c("white", "#888888"))+
ggtitle("Effect of pyriproxyfen on Pkbr3") +
scale_y_continuous(breaks=seq(0,2,by = 0.1)) +
theme_bw(15)
#boxplot
Pkbr3box<-subset(dataB, Gene=="M.Pkbr3")
Pkbr3box
Pkbr3box<-select(Pkbr3box, gene.normal,Stage.treated, Treatment)
br3box<-ggplot(data = Pkbr3box, aes(x = Stage.treated, y = gene.normal)) +
geom_boxplot(aes(fill = Treatment), width = 0.8, size=1) +
ylab("Pkbr1 Z2 relative amount/rpL32") +
scale_fill_manual(name="", # Legend label, use darker colors
breaks=c("A.Methanol", "B.5mM"),
labels=c("methanol","5mM pyriproxyfen"),
values=c("white", "grey")) +
scale_y_continuous(breaks=seq(0,2,by = 0.05)) + theme_bw(25)
br3box
postscript("Figure5E-Pkbr3boxplot.ps")
br3box
dev.off()
```
##Figure5F
```{r}
Pkbr3Z2<-subset(dataBs,dataBs$Gene=="N.Pkbr3.Z2")
ggplot(Pkbr3Z2, aes(x=Stage.treated, y=gene.normal, fill=Treatment)) +
geom_bar(position=position_dodge(), stat="identity",
colour="black", # Use black outlines,
size=1) +      # Thinner lines
geom_errorbar(aes(ymin=gene.normal-se, ymax=gene.normal+se),
size=.8,    # Thinner lines
width=.2,
position=position_dodge(.9)) +
xlab("") +
ylab("Pkbr3 Z2 relative expression/rp49") +
scale_fill_manual(name="Treatment", # Legend label, use darker colors
breaks=c("A.Methanol", "B.5mM"),
labels=c("methanol","5mM pyriproxyfen"),
values=c("white", "#888888"))+
ggtitle("Effect of pyriproxyfen on Pkbr3 Z2") +
scale_y_continuous(breaks=seq(0,2,by = 0.1)) +
theme_bw(15)
#boxplot
Pkbr3Z2box<-subset(dataB, Gene=="N.Pkbr3.Z2")
Pkbr3Z2box
Pkbr3Z2box<-select(Pkbr3Z2box, gene.normal,Stage.treated, Treatment)
br3Z2box<-ggplot(data = Pkbr3Z2box, aes(x = Stage.treated, y = gene.normal)) +
geom_boxplot(aes(fill = Treatment), width = 0.8, size=1) +
ylab("Pkbr1 Z2 relative amount/rpL32") +
scale_fill_manual(name="", # Legend label, use darker colors
breaks=c("A.Methanol", "B.5mM"),
labels=c("methanol","5mM pyriproxyfen"),
values=c("white", "grey")) +
scale_y_continuous(breaks=seq(0,2,by = 0.05)) + theme_bw(25)
br3Z2box
postscript("Figure5F-Pkbr3Z2boxplot.ps")
br3Z2box
dev.off()
```
###Figure  Pkbr2 and Pkbr2 Z2, Z4
```{r}
Pkbr2<-subset(dataBs,dataBs$Gene=="J.Pkbr2")
ggplot(Pkbr2, aes(x=Stage.treated, y=gene.normal, fill=Treatment)) +
geom_bar(position=position_dodge(), stat="identity",
colour="black", # Use black outlines,
size=1) +      # Thinner lines
geom_errorbar(aes(ymin=gene.normal-se, ymax=gene.normal+se),
size=.8,    # Thinner lines
width=.2,
position=position_dodge(.9)) +
xlab("") +
ylab("Pkbr2 relative expression/rp49") +
scale_fill_manual(name="Treatment", # Legend label, use darker colors
breaks=c("A.Methanol", "B.5mM"),
labels=c("methanol","5mM pyriproxyfen"),
values=c("white", "#888888"))+
ggtitle("Effect of pyriproxyfen on Pkbr3 Z2") +
scale_y_continuous(breaks=seq(0,2,by = 0.1)) +
theme_bw(15)
#boxplot
Pkbr2box<-subset(dataB, Gene=="J.Pkbr2")
Pkbr2box
Pkbr2box<-select(Pkbr2box, gene.normal,Stage.treated, Treatment)
br2box<-ggplot(data = Pkbr2box, aes(x = Stage.treated, y = gene.normal)) +
geom_boxplot(aes(fill = Treatment), width = 0.8, size=1) +
ylab("Pkbr2 relative amount/rpL32") +
scale_fill_manual(name="", # Legend label, use darker colors
breaks=c("A.Methanol", "B.5mM"),
labels=c("methanol","5mM pyriproxyfen"),
values=c("white", "grey")) +
scale_y_continuous(breaks=seq(0,2,by = 0.005)) + theme_bw(25)
br2box
postscript("FigureS-Pkbr2boxplot.ps")
br2box
dev.off()
```
```{r}
Pkbr2Z2<-subset(dataBs,dataBs$Gene=="K.Pkbr2.Z2")
ggplot(Pkbr2Z2, aes(x=Stage.treated, y=gene.normal, fill=Treatment)) +
geom_bar(position=position_dodge(), stat="identity",
colour="black", # Use black outlines,
size=1) +      # Thinner lines
geom_errorbar(aes(ymin=gene.normal-se, ymax=gene.normal+se),
size=.8,    # Thinner lines
width=.2,
position=position_dodge(.9)) +
xlab("") +
ylab("Pkbr2 Z2 relative expression/rp49") +
scale_fill_manual(name="Treatment", # Legend label, use darker colors
breaks=c("A.Methanol", "B.5mM"),
labels=c("methanol","5mM pyriproxyfen"),
values=c("white", "#888888"))+
##ggtitle("Effect of pyriproxyfen on Pkbr3 Z2") +
scale_y_continuous(breaks=seq(0,2,by = 0.1)) +
theme_bw(15)
#boxplot
Pkbr2Z2box<-subset(dataB, Gene=="K.Pkbr2.Z2")
Pkbr2Z2box
Pkbr2Z2box<-select(Pkbr2Z2box, gene.normal,Stage.treated, Treatment)
br2Z2box<-ggplot(data = Pkbr2Z2box, aes(x = Stage.treated, y = gene.normal)) +
geom_boxplot(aes(fill = Treatment), width = 0.8, size=1) +
ylab("Pkbr2 Z2 relative amount/rpL32") +
scale_fill_manual(name="", # Legend label, use darker colors
breaks=c("A.Methanol", "B.5mM"),
labels=c("methanol","5mM pyriproxyfen"),
values=c("white", "grey")) +
scale_y_continuous(breaks=seq(0,2,by = 0.005)) + theme_bw(25)
br2Z2box
postscript("FigureS-Pkbr2Z2boxplot.ps")
br2Z2box
dev.off()
```
```{r}
Pkbr2Z4<-subset(dataBs,dataBs$Gene=="L.Pkbr2.Z4")
ggplot(Pkbr2Z4, aes(x=Stage.treated, y=gene.normal, fill=Treatment)) +
geom_bar(position=position_dodge(), stat="identity",
colour="black", # Use black outlines,
size=1) +      # Thinner lines
geom_errorbar(aes(ymin=gene.normal-se, ymax=gene.normal+se),
size=.8,    # Thinner lines
width=.2,
position=position_dodge(.9)) +
xlab("") +
ylab("Pkbr2 Z4 relative expression/rp49") +
scale_fill_manual(name="Treatment", # Legend label, use darker colors
breaks=c("A.Methanol", "B.5mM"),
labels=c("methanol","5mM pyriproxyfen"),
values=c("white", "#888888"))+
##ggtitle("Effect of pyriproxyfen on Pkbr3 Z2") +
scale_y_continuous(breaks=seq(0,2,by = 0.1)) +
theme_bw(15)
#boxplot
Pkbr2Z4box<-subset(dataB, Gene=="L.Pkbr2.Z4")
Pkbr2Z4box
Pkbr2Z4box<-select(Pkbr2Z4box, gene.normal,Stage.treated, Treatment)
br2Z4box<-ggplot(data = Pkbr2Z4box, aes(x = Stage.treated, y = gene.normal)) +
geom_boxplot(aes(fill = Treatment), width = 0.8, size=1) +
ylab("Pkbr2 Z2 relative amount/rpL32") +
scale_fill_manual(name="", # Legend label, use darker colors
breaks=c("A.Methanol", "B.5mM"),
labels=c("methanol","5mM pyriproxyfen"),
values=c("white", "grey")) +
scale_y_continuous(breaks=seq(0,2,by = 0.005)) + theme_bw(25)
br2Z4box
postscript("FigureS-Pkbr2Z4boxplot.ps")
br2Z4box
dev.off()
```
###Statistical tests
```{r}
#subsetting original data for statistical tests prepupae
Pkbr1
prepupatestPkbr1<-subset(dataB,dataB$Stage.treated=="PreD1" & dataB$Gene=="G.Pkbr1")
t.test(gene.normal~Treatment,data=prepupatestPkbr1)
pupatestPkbr1<-subset(dataB,dataB$Stage.treated=="PuD0" & dataB$Gene=="G.Pkbr1")
t.test(gene.normal~Treatment,data=pupatestPkbr1)
Pkbr1Z2
prepupatestPkbr1z2<-subset(dataB,dataB$Stage.treated=="PreD1" & dataB$Gene=="H.Pkbr1.Z2")
t.test(gene.normal~Treatment,data=prepupatestPkbr1z2)
pupatestPkbr1z2<-subset(dataB,dataB$Stage.treated=="PuD0" & dataB$Gene=="H.Pkbr1.Z2")
t.test(gene.normal~Treatment,data=pupatestPkbr1z2)
Pkbr1Z4
prepupatestPkbr1z4<-subset(dataB,dataB$Stage.treated=="PreD1" & dataB$Gene=="I.Pkbr1.Z4")
t.test(gene.normal~Treatment,data=prepupatestPkbr1z4)
pupatestPkbr1z4<-subset(dataB,dataB$Stage.treated=="PuD0" & dataB$Gene=="I.Pkbr1.Z4")
t.test(gene.normal~Treatment,data=pupatestPkbr1z4)
Pkbr2
prepupatestPkbr2<-subset(dataB,dataB$Stage.treated=="PreD1" & dataB$Gene=="J.Pkbr2")
t.test(gene.normal~Treatment,data=prepupatestPkbr2)
pupatestPkbr2<-subset(dataB,dataB$Stage.treated=="PuD0" & dataB$Gene=="J.Pkbr2")
t.test(gene.normal~Treatment,data=pupatestPkbr2)
Pkbr2Z2
prepupatestPkbr2z2<-subset(dataB,dataB$Stage.treated=="PreD1" & dataB$Gene=="K.Pkbr2.Z2")
t.test(gene.normal~Treatment,data=prepupatestPkbr2z2)
pupatestPkbr2z2<-subset(dataB,dataB$Stage.treated=="PuD0" & dataB$Gene=="K.Pkbr2.Z2")
t.test(gene.normal~Treatment,data=pupatestPkbr2z2)
Pkbr2Z4
prepupatestPkbr2z4<-subset(dataB,dataB$Stage.treated=="PreD1" & dataB$Gene=="L.Pkbr2.Z4")
t.test(gene.normal~Treatment,data=prepupatestPkbr2z4)
pupatestPkbr2z4<-subset(dataB,dataB$Stage.treated=="PuD0" & dataB$Gene=="L.Pkbr2.Z4")
t.test(gene.normal~Treatment,data=pupatestPkbr2z4)
Pkbr3
prepupatestPkbr3<-subset(dataB,dataB$Stage.treated=="PreD1" & dataB$Gene=="M.Pkbr3")
t.test(gene.normal~Treatment,data=prepupatestPkbr3)
pupatestPkbr3<-subset(dataB,dataB$Stage.treated=="PuD0" & dataB$Gene=="M.Pkbr3")
t.test(gene.normal~Treatment,data=pupatestPkbr3)
Pkbr3Z2
prepupatestPkbr3z2<-subset(dataB,dataB$Stage.treated=="PreD1" & dataB$Gene=="N.Pkbr3.Z2")
t.test(gene.normal~Treatment,data=prepupatestPkbr3z2)
pupatestPkbr3z2<-subset(dataB,dataB$Stage.treated=="PuD0" & dataB$Gene=="N.Pkbr3.Z2")
t.test(gene.normal~Treatment,data=pupatestPkbr3z2)
```
#Supplementary material
##Figure Taiman 5A and B and INDEL
```{r}
FigureSTai<-subset(dataA3,Gene=="SDM.Tai.IN"|Gene=="SDM.Tai.DEL")
pFigSTai<-ggplot(FigureSTai, aes(x=Day.after.hatching,y=meanSDM/meanrp49,group=Sex)) +
geom_point(aes(linetype=Sex),size=2)+
geom_line(aes(linetype=Sex),size=0.5)+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), axis.line = element_line(colour = "black"))+
ylab("Gene relative expression (/rpL32)") +xlab("days after oviposition") +
theme_bw(15) +
theme(axis.title.x = element_text(colour = "#242424"))
pFigSTai+facet_grid(Gene~.,scales="free")
FigureSTai5<-subset(dataA3,Gene=="SDM.Tai5A"|Gene=="SDM.Tai5B")
pFigSTai5<-ggplot(FigureSTai5, aes(x=Day.after.hatching,y=meanSDM/meanrp49,group=Sex)) +
geom_point(aes(linetype=Sex),size=2)+
geom_line(aes(linetype=Sex),size=0.5)+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), axis.line = element_line(colour = "black"))+
ylab("Gene relative expression (/rpL32)") +xlab("days after oviposition") +
theme_bw(15) +
theme(axis.title.x = element_text(colour = "#242424"))
pFigSTai5+facet_grid(Gene~.,scales="free")
```
```
##Figure Taiman pyriproxyfen
```{r}
PkTai<-subset(dataBs,dataBs$Gene=="O.Tai")
ggplot(PkTai, aes(x=Stage.treated, y=gene.normal, fill=Treatment)) +
geom_bar(position=position_dodge(), stat="identity",
colour="black", # Use black outlines,
size=1) +      # Thinner lines
geom_errorbar(aes(ymin=gene.normal-se, ymax=gene.normal+se),
size=.8,    # Thinner lines
width=.2,
position=position_dodge(.9)) +
xlab("") +
ylab("PkTai common relative expression/rp49") +
scale_fill_manual(name="Treatment", # Legend label, use darker colors
breaks=c("A.Methanol", "B.5mM"),
labels=c("methanol","5mM pyriproxyfen"),
values=c("white", "#888888"))+
ggtitle("Effect of pyriproxyfen on PkTai") +
scale_y_continuous(breaks=seq(0,2,by = 0.1)) +
theme_bw(15)
#boxplot
PkTaibox<-subset(dataB, Gene=="O.Tai")
PkTaibox
PkTaibox<-select(PkTaibox, gene.normal,Stage.treated, Treatment)
Taibox<-ggplot(data = PkTaibox, aes(x = Stage.treated, y = gene.normal)) +
geom_boxplot(aes(fill = Treatment), width = 0.8, size=1) +
ylab("PkTai relative amount/rpL32") +
scale_fill_manual(name="", # Legend label, use darker colors
breaks=c("A.Methanol", "B.5mM"),
labels=c("methanol","5mM pyriproxyfen"),
values=c("white", "grey")) +
scale_y_continuous(breaks=seq(0,2,by = 0.2)) + theme_bw(25)
Taibox
postscript("FigureS-PkTaiboxplot.ps")
Taibox
dev.off()
PkTai
prepupatestPkTai<-subset(dataB,dataB$Stage.treated=="PreD1" & dataB$Gene=="O.Tai")
t.test(gene.normal~Treatment,data=prepupatestPkTai)
pupatestPkTai<-subset(dataB,dataB$Stage.treated=="PuD0" & dataB$Gene=="O.Tai")
t.test(gene.normal~Treatment,data=pupatestPkTai)
```
##AVERAGE FOLD CHANGE
```{r}
dataBs$log2.gene.normal<-log2(dataBs$gene.normal)
methanol<-subset(dataBs,Treatment=="A.Methanol")
pyri<-subset(dataBs,Treatment=="B.5mM")
log2FC<- pyri$log2.gene.normal - methanol$log2.gene.normal
log2FC
log2FC.MP<- methanol$log2.gene.normal - pyri$log2.gene.normal
FC<- 2 ^ log2FC
FC.MP<- 2 ^ log2FC.MP
division<-pyri$gene.normal / methanol$gene.normal
division.MP<-methanol$gene.normal / pyri$gene.normal
FCdata <- data.frame(matrix("", ncol = 8, nrow = 30))
colnames(FCdata)<-c("Stage.treated","gene","log2FC","FC","division","log2FC.MP","FC.MP","division.MP")
FCdata$log2FC<-log2FC
FCdata$FC<-FC
FCdata$log2FC.MP<-log2FC.MP
FCdata$FC.MP<-FC.MP
FCdata$Stage.treated<-pyri$Stage.treated
FCdata$gene<-pyri$Gene
FCdata$division<-division
FCdata$division.MP<-division.MP
FCdata
plot(FCdata$division~log2FC)
```
##MEDIAN FOLD CHANGE
```{r,echo=FALSE}
library(ggplot2)
library(plyr)
library(tidyr)
##script source for summarizeSE: http://www.cookbook-r.com/Graphs/Plotting_means_and_error_bars_(ggplot2)/#Helper functions
## Gives count, mean, standard deviation, standard error of the mean, and confidence interval (default 95%).
##   data: a data frame.
##   measurevar: the name of a column that contains the variable to be summariezed
##   groupvars: a vector containing names of columns that contain grouping variables
##   na.rm: a boolean that indicates whether to ignore NA's
##   conf.interval: the percent range of the confidence interval (default is 95%)
summarySE <- function(data=NULL, measurevar, groupvars=NULL, na.rm=FALSE,
conf.interval=.95, .drop=TRUE) {
library(plyr)
# New version of length which can handle NA's: if na.rm==T, don't count them
length2 <- function (x, na.rm=FALSE) {
if (na.rm) sum(!is.na(x))
else       length(x)
}
# This does the summary. For each group's data frame, return a vector with
# N, mean, and sd
datac <- ddply(data, groupvars, .drop=.drop,
.fun = function(xx, col) {
c(N    = length2(xx[[col]], na.rm=na.rm),
mean = mean   (xx[[col]], na.rm=na.rm),
sd   = sd     (xx[[col]], na.rm=na.rm)
)
},
measurevar
)
# Rename the "mean" column
datac <- rename(datac, c("mean" = measurevar))
datac$se <- datac$sd / sqrt(datac$N)  # Calculate standard error of the mean
# Confidence interval multiplier for standard error
# Calculate t-statistic for confidence interval:
# e.g., if conf.interval is .95, use .975 (above/below), and use df=N-1
ciMult <- qt(conf.interval/2 + .5, datac$N-1)
datac$ci <- datac$se * ciMult
return(datac)
}
```
setwd("/Users/ivea/Dropbox/_Github_reps/mealybugJH/")
dataA<-read.csv(file="expressionprofile.csv",header =TRUE)
dataB<-read.csv(file="Pyri5mM.csv",header = TRUE)
dataA2<-gather(dataA,Gene,SDM,7:24)
dataA3<-ddply(dataA2,~Day.after.hatching +Sex+Gene,summarise,meanrp49=mean(SDM.rp49.2),meanSDM=mean(SDM))
dataB$gene.normal<-dataB$SDM.gene/dataB$rp49.2
dataBs<-summarySE(dataB, measurevar="gene.normal", groupvars=c("Treatment","Stage.treated","Gene"))
Figure2<-subset(dataA3,Gene=="SDM.JHAMT"|Gene=="SDM.Met"|Gene=="SDM.Tai"|Gene=="SDM.Pkkr.h1_26")
pFig1<-ggplot(Figure2, aes(x=Day.after.hatching,y=meanSDM/meanrp49,group=Sex)) +
geom_point(aes(linetype=Sex),size=2)+
geom_line(aes(linetype=Sex),size=0.5)+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), axis.line = element_line(colour = "black"))+
ylab("Gene relative expression (/rpL32)") +xlab("days after oviposition") +
theme_bw(15) +
theme(axis.title.x = element_text(colour = "#242424"))
pFig1+facet_grid(Gene~.,scales="free")
PkMet<-subset(dataBs,dataBs$Gene=="B.Met")
PkMetp<-ggplot(PkMet, aes(x=Stage.treated, y=gene.normal, fill=Treatment)) +
geom_bar(position=position_dodge(width=0.9),width=0.75, stat="identity",
colour="black", # Use black outlines,
size=1) +      # Thinner lines
geom_errorbar(aes(ymin=gene.normal, ymax=gene.normal+se),
size=.8,    # Thinner lines
width=.2,
position=position_dodge(0.9)) +
xlab("") +
#ylab("PkMet relative amount/rpL32") +
scale_fill_manual(name="", # Legend label, use darker colors
breaks=c("A.Methanol", "B.5mM"),
labels=c("methanol","5mM pyriproxyfen"),
values=c("white", "black"))+
#ggtitle("Effect of pyriproxyfen on PkMet") +
scale_y_continuous(breaks=seq(0,2,by = 0.1)) +
theme_bw(25)
PkMetp
postscript("Figure3C-PkMet.ps")
PkMetp
dev.off()
PkMet<-subset(dataBs,dataBs$Gene=="B.Met")
PkMetp<-ggplot(PkMet, aes(x=Stage.treated, y=gene.normal, fill=Treatment)) +
geom_bar(position=position_dodge(width=0.9),width=0.75, stat="identity",
colour="black", # Use black outlines,
size=1) +      # Thinner lines
geom_errorbar(aes(ymin=gene.normal, ymax=gene.normal+se),
size=.8,    # Thinner lines
width=.2,
position=position_dodge(0.9)) +
xlab("") +
#ylab("PkMet relative amount/rpL32") +
scale_fill_manual(name="", # Legend label, use darker colors
breaks=c("A.Methanol", "B.5mM"),
labels=c("methanol","5mM pyriproxyfen"),
values=c("white", "black"))+
#ggtitle("Effect of pyriproxyfen on PkMet") +
scale_y_continuous(breaks=seq(0,2,by = 0.1)) +
theme_bw(25)
PkMetp
PkMet<-subset(dataBs,dataBs$Gene=="B.Met")
PkMetp<-ggplot(PkMet, aes(x=Stage.treated, y=gene.normal, fill=Treatment)) +
geom_bar(position=position_dodge(width=0.9),width=0.75, stat="identity",
colour="black", # Use black outlines,
size=1) +      # Thinner lines
geom_errorbar(aes(ymin=gene.normal, ymax=gene.normal+se),
size=.8,    # Thinner lines
width=.2,
position=position_dodge(0.9)) +
xlab("") +
#ylab("PkMet relative amount/rpL32") +
scale_fill_manual(name="", # Legend label, use darker colors
breaks=c("A.Methanol", "B.5mM"),
labels=c("methanol","5mM pyriproxyfen"),
values=c("white", "black"))+
#ggtitle("Effect of pyriproxyfen on PkMet") +
scale_y_continuous(breaks=seq(0,2,by = 0.1)) +
theme_bw(25)
PkMet<-subset(dataBs,dataBs$Gene=="B.Met")
dataBs<-summarySE(dataB, measurevar="gene.normal", groupvars=c("Treatment","Stage.treated","Gene"))
dataB$gene.normal<-dataB$SDM.gene/dataB$rp49.2
dataBs<-summarySE(dataB, measurevar="gene.normal", groupvars=c("Treatment","Stage.treated","Gene"))
